<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Weekly Wednesday</title>

  <!-- Your existing stylesheet -->
  <link rel="stylesheet" href="./assets/styles.css">

  <!-- Light extra styling for the video section + fallback button -->
  <style>
    .section-title { margin: 0 0 6px; font-size: 18px; }
    .section-sub { margin: 0; color: var(--muted, #6b7280); font-size: 14px; }
    .spacer { height: 14px; }

    .video-grid {
      margin-top: 16px;
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }

    .video-card {
      background: var(--card, #ffffff);
      border: 1px solid var(--border, #e5e7eb);
      border-radius: 16px;
      box-shadow: var(--shadow, 0 10px 28px rgba(17,24,39,.08));
      padding: 14px;
    }

    .embed-wrap {
      position: relative;
      width: 100%;
      height: 0;
      padding-bottom: 56.25%; /* 16:9 */
      border-radius: 14px;
      overflow: hidden;
      border: 1px solid var(--border, #e5e7eb);
      background: #000;
    }
    .embed-wrap iframe {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      border: 0;
    }

    .video-meta {
      margin-top: 10px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      justify-content: space-between;
    }

    .video-caption {
      color: var(--muted, #6b7280);
      font-size: 13px;
      margin: 0;
    }

    .btn {
      appearance: none;
      border: 1px solid var(--border, #e5e7eb);
      background: #fff;
      color: var(--text, #111827);
      border-radius: 12px;
      padding: 9px 12px;
      cursor: pointer;
      text-decoration: none;
      font-size: 13px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      white-space: nowrap;
    }
    .btn:hover { filter: brightness(0.98); }
  </style>
</head>

<body>
  <div class="topbar">
    <div class="container">
      <div class="brand">
        <h1>Weekly Wednesday 01/28/2026</h1>
        <p>Winter Weather Photos + Videos</p>
      </div>

      <div class="nav">
        <a href="./">Home</a>
        <a href="#photos">Photos</a>
        <a href="#videos">Videos</a>
      </div>
    </div>
  </div>

  <main>
    <div class="container">

      <!-- PHOTOS -->
      <div class="panel" id="photos">
        <h2 class="section-title">Photos</h2>
        <p class="section-sub">Click any photo to view it larger.</p>

        <div class="status" id="status">Loading photos…</div>
        <div class="grid" id="grid"></div>
      </div>

      <div class="spacer"></div>

      <!-- VIDEOS -->
      <div class="panel" id="videos">
        <h2 class="section-title">Videos</h2>
        <p class="section-sub">Uploaded by our awesome employees!</p>

        <div class="video-grid" id="videoGrid"></div>
      </div>

      <div class="footer">© 2026</div>
    </div>
  </main>

  <!-- Lightbox for photos -->
  <div class="lightbox" id="lightbox" aria-hidden="true">
    <button class="close" id="closeBtn">Close ✕</button>
    <img id="lightboxImg" alt="Expanded photo" />
  </div>

  <script>
    // ========== CONFIG ==========
    // Add more videos by adding another object to this array.
    const videos = [
      {
        // Your Canva link:
        url: "https://www.canva.com/design/DAG_uhscOlQ/C5xz9iot2yEhYMmtfQlSLw/watch",
        caption: "Weekly Wednesday video"
      }
    ];

    // ========== HELPERS ==========
    function normalizeCanvaEmbedUrl(url) {
      // Canva embeds commonly work by appending ?embed to a view/watch URL.
      // If you already have query params, append &embed; otherwise ?embed.
      const hasQuery = url.includes("?");
      const alreadyEmbed = url.includes("embed");
      if (alreadyEmbed) return url;
      return url + (hasQuery ? "&embed" : "?embed");
    }

    // ========== PHOTOS ==========
    const grid = document.getElementById('grid');
    const statusEl = document.getElementById('status');
    const lightbox = document.getElementById('lightbox');
    const lightboxImg = document.getElementById('lightboxImg');
    const closeBtn = document.getElementById('closeBtn');

    function openLightbox(src) {
      lightboxImg.src = src;
      lightbox.classList.add('open');
      lightbox.setAttribute('aria-hidden', 'false');
    }
    function closeLightbox() {
      lightbox.classList.remove('open');
      lightbox.setAttribute('aria-hidden', 'true');
      lightboxImg.src = '';
    }

    closeBtn.addEventListener('click', closeLightbox);
    lightbox.addEventListener('click', (e) => { if (e.target === lightbox) closeLightbox(); });
    window.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeLightbox(); });

    async function loadPhotos() {
      try {
        const res = await fetch('./photos.json', { cache: 'no-store' });
        if (!res.ok) throw new Error('photos.json missing');
        const items = await res.json();

        if (!Array.isArray(items) || items.length === 0) {
          statusEl.textContent = 'No photos listed yet. Add entries to photos.json.';
          return;
        }

        statusEl.textContent = '';

        items.forEach(item => {
          // Supports both formats:
          // 1) "01.jpg"
          // 2) { "file": "01.jpg", "caption": "..." }
          const file = (typeof item === 'string') ? item : item.file;
          const caption = (typeof item === 'string') ? "" : (item.caption || "");

          const tile = document.createElement('div');
          tile.className = 'tile';

          const img = document.createElement('img');
          img.src = `./photos/${file}`;
          img.alt = caption || file;
          img.loading = 'lazy';

          const cap = document.createElement('div');
          cap.className = 'cap';
          if (caption && caption.trim().length > 0) {
            cap.textContent = caption;
          } else {
            cap.style.display = 'none';
          }

          tile.appendChild(img);
          tile.appendChild(cap);
          tile.addEventListener('click', () => openLightbox(img.src));
          grid.appendChild(tile);
        });
      } catch (err) {
        statusEl.textContent = 'Could not load photos.json. Make sure it exists in the repo root.';
      }
    }

    // ========== VIDEOS ==========
    const videoGrid = document.getElementById('videoGrid');

    function renderVideos() {
      videos.forEach(v => {
        const card = document.createElement('div');
        card.className = 'video-card';

        const embedWrap = document.createElement('div');
        embedWrap.className = 'embed-wrap';

        const iframe = document.createElement('iframe');
        iframe.src = normalizeCanvaEmbedUrl(v.url);
        iframe.allowFullscreen = true;
        iframe.setAttribute('allow', 'fullscreen *');

        embedWrap.appendChild(iframe);

        const meta = document.createElement('div');
        meta.className = 'video-meta';

        const cap = document.createElement('p');
        cap.className = 'video-caption';
        cap.textContent = v.caption || '';

        const link = document.createElement('a');
        link.className = 'btn';
        link.href = v.url;
        link.target = '_blank';
        link.rel = 'noopener';
        link.textContent = 'Open video in Canva ↗';

        meta.appendChild(cap);
        meta.appendChild(link);

        card.appendChild(embedWrap);
        card.appendChild(meta);

        videoGrid.appendChild(card);
      });
    }

    // Kick off
    loadPhotos();
    renderVideos();
  </script>
</body>
</html>
